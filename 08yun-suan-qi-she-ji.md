# 08 运算器设计
### 二进制与逻辑电路
* 计算机中数的表示：原码/补码/移码、 IEEE 754浮点数表示
    * IEEE 754：
        * 单精度（32位）：1位符号，8位阶码，23位尾数
        * 双精度（64位）：1位符号，11位阶码，52位尾数
    
    尾数用原码表示，规格化尾数统一表示为1.xxx的形式（隐藏后尾数可多一位表示，精度提高一位）
        * 无穷大：阶码全1尾数全0
        * 非数（没有定义的数NaN）：阶码全1尾数非0
        * 规格化非0数（阶码非全0非全1）：符号位为0：$$1.f\times2^{e-127}$$（单精度）和$$0.f\times2^{e-1023}$$（双精度）；符号位为1：$$-1.f\times2^{e-127}$$（单精度）和$$-1.f\times2^{e-1023}$$（双精度）
        * 非规格化非0数（阶码全0尾数非0）：符号位为0：$$0.f\times2^{-126}$$（单精度）和$$0.f\times2^{-1022}$$（双精度）；符号位为1：$$-0.f\times2^{-126}$$（单精度）和$$-0.f\times2^{-1022}$$（双精度）

* MOS晶体管工作原理：NMOS管和PMOS管
* CMOS逻辑电路：组合逻辑和时序逻辑、CMOS晶体管级电路图

### 简单运算器设计
* 定点补码加法器:先行进位
    * 延迟
        * 行波进位延迟：(n-1)*2+3
        * 块内并行块间串行：t_{pg}+2*n/4+3
            > t_{pg}：16级：1，32/64：2
        * 块内并行块间并行：画图吧，加上3位全加器
* 减法运算实现:减数按位取反，进位加一
    * 溢出后，结果与真实符号相反
* 比较运算实现、移位器
    * 比较器：
        * 判等：异或，逐bit比较
        * 判断大小：A-B与0比
    * 移位器：
        * 逻辑右移：高位补0
        * 算术右移：高位补符号位
        * 循环右移：高位补右侧挤掉的数据

### 定点补码乘法器
* 补码乘法器
    * 符号位扩充到n位，结果保留n位
    * 最高那位是符号位
* Booth乘法器:两位一乘算法（n/2次循环）
    * 一位一乘
    
| yi | yi-1 | 操作 |
| --- | --- | --- |
| 0 | 0 | +0 |
| 0 | 1 | +[x]补 |
| 1 | 0 | -[x]补 |
| 1 | 1 | +0 |
    * 二位一乘
    
| yi+1 | yi | yi-1 | 操作 |
| --- | --- | --- | --- |
| 0 | 0 | 0 | +0 |
| 0 | 0 | 1 | +[x]补 |
| 0 | 1 | 0 | +[x]补 |
| 0 | 1 | 1 | +2[x]补 |
| 1 | 0 | 0 | -2[x]补 |
| 1 | 0 | 1 | -[x]补 |
| 1 | 1 | 0 | -[x]补 |
| 1 | 1 | 1 | -0 |
* 华莱士树:进位传递过程
    * 一份全加器可以将3个数相加转换为2个数相加，某层全加器个数y/3
    * n/2-2个用于传递进位，增加一个半加器