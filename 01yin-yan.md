# 01 引言
### 计算机体系结构
描述计算机各组成部分及其相互关系的一组规则和方法
* ISA：指令系统结构
* CO： 计算机组织结构->**以冯·诺依曼结构为基础**
    * +微体系结构（微处理器）
    * +并行体系结构（并行处理器）
    
    冯诺依曼结构核心思想：（也是计算机体系结构的基本原理）
        * 存储程序（数据和程序都在存储器中）
        * 指令驱动执行原理
    
### 表现方式
* 结构框图
* 高级语言
* 硬件描述语言

### 四个层次三个界面

| 四个层次 | 三个界面 | 
| --- | --- | 
| 应用 | |
| | API（应用程序编程接口） |
| OS | |
| | ISA（指令系统）|
| 硬件 | |
| | 工艺模型 |
| 工艺 | |

API与ISA之间还有ABI（应用程序二进制接口）

### 衡量计算机的指标
* 性能
    * 最本质的定义：完成一个任务所需要的时间
        * 算法
        * 指令系统
        * 结构设计
    * IPC：每个时钟周期平均执行指令数（微结构）
    
    影响因素：
        * 单发射、多发射
        * 何种转移猜测策略
        * 什么样的存储层次设计
* 功耗：
    * 静态功耗
        * 漏电功耗
    * 动态功耗
        * 开关功耗
        * 短路功耗
        
#### 主频
* 宏观：微结构设计
* 微观：工艺和电路设计

### 发展趋势
* 摩尔定律：本质上是晶体管尺寸以及晶体管翻转速度变化定律（主频）
    * 到头了
* 计算机体系结构随着应用需求的变化而不断变化
* 目前计算机体系结构的进一步发展面临复杂度、主频、功耗、带宽等障碍

**基础软硬件趋于成熟，应用创新方兴未艾，硅平台成为应用创新的重要平台（算法在硅上实现）**
性能->性价比->性能功耗

### 计算机体系结构的设计原则
* 平衡性：一个结构最终体现出的性能受限于其瓶颈部分
    * Amdahl定律：性能提升不仅与其中一些指令的运行时间的优化有关，还和这些指令在总指令数中所占比例有关
    $$ Extime_{new} = Extime_{old} \times ((1-Fraction_{enhanced}) + (Fraction_{enhanced} / Speedup_{enhanced}))$$ 
    $$Speedup_{enhanced} = Extime_{old} / Extime_{new}$$
* 局部性：利用访存局部性进行优化是体系结构提升访存指令性能的重要方法
    * 时间局部性：一个数据被访问后很可能多次被访问
    * 空间局部性：一个数据被访问后，它邻近的数据很可能被访问
    
    高速缓存、TLB、预取
* 并行性（并行化）
    * 指令级并行
        * 时间并行，指令流水线
        * 空间并行，多发射
    * 数据集并行
        * SIMD单指令流多数据流的向量结构
        * GPU
    * 任务级并行：并行粒度较大
        * 多核处理器及多线程处理器（目前计算机体系结构提高性能的主要方法）
* 虚拟化：体系结构设计者为用户提供一个友好界面的基本方法
    * 虚拟存储技术虚拟了内存
    * 多线程和虚拟机技术虚拟了CPU
    * 流水线和多发射
    * Cache技术